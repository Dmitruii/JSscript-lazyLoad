const lazyImages=document.querySelectorAll("img[data-src], source[data-srcset]"),LoadMapBlock=document.querySelector("._load-map"),windowHeight=document.documentElement.clientHeight,loadMoreBlock=document.querySelector("._load-more");let lazyImagesPositions=[];function lazyScroll(){lazyImages.length>0&&lazyScrollCheck(),LoadMapBlock.classList.contains("_loaded")||getMap(),loadMoreBlock.classList.contains("_loading")||loadMore()}function lazyScrollCheck(){let e=lazyImagesPositions.findIndex(e=>pageYOffset>e-windowHeight);e>=0&&(lazyImages[e].dataset.src?(lazyImages[e].src=lazyImages[e].dataset.src,lazyImages[e].removeAttribute("data-src")):lazyImages[e].dataset.srcset&&(lazyImages[e].srcset=lazyImages[e].dataset.srcset,lazyImages[e].removeAttribute("data-srcset")),delete lazyImagesPositions[e])}function getMap(){const e=LoadMapBlock.getBoundingClientRect().top+pageYOffset;if(pageYOffset>e-windowHeight){const e=LoadMapBlock.dataset.map;e&&(LoadMapBlock.insertAdjacentHTML("beforeend",`<iframe src="${e}" width="100%" height="450" style="border:0;" allowfullscreen="" loading='lazy'></iframe>`),LoadMapBlock.classList.add("_loaded"))}}function loadMore(){const e=LoadMapBlock.getBoundingClientRect().top+pageYOffset,a=loadMoreBlock.offsetHeight;pageYOffset>e+a-windowHeight&&getContent()}async function getContent(){document.querySelector("._loading-icon")||loadMoreBlock.insertAdjacentHTML("beforeend","<div class='_loading-icon'></div>"),loadMoreBlock.classList.add("_loading");let e=await fetch("_more.html",{method:"GET"});if(e.ok){let a=await e.text();loadMoreBlock.insertAdjacentHTML("beforeend",a),loadMoreBlock.classList.remove("_loading"),document.querySelector("._loading-icon")?document.querySelector("._loading-icon").remove():alert("Error")}}lazyImages.length>=0&&lazyImages.forEach(e=>{(e.dataset.src||e.dataset.srcset)&&(lazyImagesPositions.push(e.getBoundingClientRect().top+pageYOffset),lazyScrollCheck())}),window.addEventListener("scroll",lazyScroll);